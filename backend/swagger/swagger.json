{
  "openapi": "3.0.0",
  "info": {
    "title": "Kapital API Documentation",
    "version": "1.0.0",
    "description": "API documentation for Kapital backend services"
  },
  "servers": [
    {
      "url": "http://localhost:4001",
      "description": "Local development server"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": false
          },
          "message": {
            "type": "string",
            "description": "Error message describing what went wrong",
            "example": "Validation failed"
          },
          "error": {
            "type": "string",
            "description": "Technical error details (optional)",
            "example": "Missing required field: loanId"
          }
        },
        "required": ["success", "message"]
      },
      "AdminLogin": {
        "type": "object",
        "required": [
          "phoneNumber",
          "password"
        ],
        "properties": {
          "phoneNumber": {
            "type": "string",
            "example": "+60123456789"
          },
          "password": {
            "type": "string",
            "example": "password123"
          }
        }
      },
      "User": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "fullName": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "phoneNumber": {
            "type": "string"
          },
          "role": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "DashboardStats": {
        "type": "object",
        "properties": {
          "totalUsers": {
            "type": "number"
          },
          "totalApplications": {
            "type": "number"
          },
          "totalLoans": {
            "type": "number"
          },
          "totalLoanAmount": {
            "type": "number"
          },
          "recentApplications": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string"
                },
                "status": {
                  "type": "string"
                },
                "createdAt": {
                  "type": "string",
                  "format": "date-time"
                },
                "user": {
                  "type": "object",
                  "properties": {
                    "fullName": {
                      "type": "string"
                    },
                    "email": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "LoanApplication": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the loan application"
          },
          "userId": {
            "type": "string",
            "description": "ID of the user who created the application"
          },
          "productId": {
            "type": "string",
            "description": "ID of the selected loan product"
          },
          "amount": {
            "type": "number",
            "description": "Loan amount requested"
          },
          "term": {
            "type": "number",
            "description": "Loan term in months"
          },
          "purpose": {
            "type": "string",
            "description": "Purpose of the loan"
          },
          "monthlyRepayment": {
            "type": "number",
            "description": "Monthly repayment amount"
          },
          "interestRate": {
            "type": "number",
            "description": "Interest rate percentage"
          },
          "lateFee": {
            "type": "number",
            "description": "Late fee amount"
          },
          "originationFee": {
            "type": "number",
            "description": "Origination fee amount"
          },
          "legalFee": {
            "type": "number",
            "description": "Legal fee amount"
          },
          "applicationFee": {
            "type": "number",
            "description": "Application fee amount"
          },
          "netDisbursement": {
            "type": "number",
            "description": "Net amount to be disbursed after fees"
          },
          "urlLink": {
            "type": "string",
            "description": "Unique URL link for the application"
          },
          "status": {
            "type": "string",
            "enum": [
              "INCOMPLETE",
              "PENDING",
              "APPROVED",
              "REJECTED",
              "DISBURSED",
              "CLOSED"
            ],
            "description": "Current status of the application"
          },
          "appStep": {
            "type": "number",
            "description": "Current step in the application process (0-4)"
          },
          "acceptTerms": {
            "type": "boolean",
            "description": "Whether the user has accepted the terms"
          },
          "paidAppFee": {
            "type": "boolean",
            "description": "Whether the application fee has been paid"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "When the application was created"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time",
            "description": "When the application was last updated"
          },
          "product": {
            "$ref": "#/components/schemas/Product"
          },
          "documents": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Document"
            }
          }
        }
      },
      "Product": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the product"
          },
          "code": {
            "type": "string",
            "description": "Product code"
          },
          "name": {
            "type": "string",
            "description": "Product name"
          },
          "description": {
            "type": "string",
            "description": "Product description"
          },
          "minAmount": {
            "type": "number",
            "description": "Minimum loan amount"
          },
          "maxAmount": {
            "type": "number",
            "description": "Maximum loan amount"
          },
          "repaymentTerms": {
            "type": "array",
            "items": {
              "type": "number"
            },
            "description": "Available repayment terms in months"
          },
          "interestRate": {
            "type": "number",
            "description": "Interest rate percentage"
          },
          "eligibility": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Eligibility criteria"
          },
          "isActive": {
            "type": "boolean",
            "description": "Whether the product is active"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "When the product was created"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time",
            "description": "When the product was last updated"
          }
        }
      },
      "ProductInput": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Product code"
          },
          "name": {
            "type": "string",
            "description": "Product name"
          },
          "description": {
            "type": "string",
            "description": "Product description"
          },
          "minAmount": {
            "type": "number",
            "description": "Minimum loan amount"
          },
          "maxAmount": {
            "type": "number",
            "description": "Maximum loan amount"
          },
          "repaymentTerms": {
            "type": "array",
            "items": {
              "type": "number"
            },
            "description": "Available repayment terms in months"
          },
          "interestRate": {
            "type": "number",
            "description": "Interest rate percentage"
          },
          "eligibility": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Eligibility criteria"
          },
          "lateFee": {
            "type": "number",
            "description": "Late payment fee percentage"
          },
          "originationFee": {
            "type": "number",
            "description": "Origination fee percentage"
          },
          "legalFee": {
            "type": "number",
            "description": "Legal fee amount"
          },
          "applicationFee": {
            "type": "number",
            "description": "Application fee amount"
          },
          "requiredDocuments": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Required document types"
          },
          "features": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Product features"
          },
          "loanTypes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Available loan purpose types"
          },
          "isActive": {
            "type": "boolean",
            "description": "Whether the product is active"
          }
        }
      },
      "Document": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the document"
          },
          "loanApplicationId": {
            "type": "string",
            "description": "ID of the loan application this document belongs to"
          },
          "documentType": {
            "type": "string",
            "description": "Type of document"
          },
          "documentUrl": {
            "type": "string",
            "description": "URL to the document"
          },
          "status": {
            "type": "string",
            "enum": [
              "PENDING",
              "APPROVED",
              "REJECTED"
            ],
            "description": "Status of the document verification"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "When the document was created"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time",
            "description": "When the document was last updated"
          }
        }
      },
      "EarlySettlementTransaction": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "loanId": {
            "type": "string"
          },
          "userId": {
            "type": "string"
          },
          "requestedAmount": {
            "type": "number"
          },
          "approvedAmount": {
            "type": "number"
          },
          "status": {
            "type": "string",
            "enum": ["PENDING", "APPROVED", "REJECTED", "COMPLETED"]
          },
          "requestedAt": {
            "type": "string",
            "format": "date-time"
          },
          "processedAt": {
            "type": "string",
            "format": "date-time"
          },
          "processedBy": {
            "type": "string"
          },
          "notes": {
            "type": "string"
          },
          "rejectionReason": {
            "type": "string"
          }
        }
      },
      "LateFee": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "repaymentId": {
            "type": "string"
          },
          "amount": {
            "type": "number"
          },
          "daysOverdue": {
            "type": "integer"
          },
          "status": {
            "type": "string",
            "enum": ["PENDING", "PAID", "WAIVED"]
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "paidAt": {
            "type": "string",
            "format": "date-time"
          },
          "waivedAt": {
            "type": "string",
            "format": "date-time"
          },
          "waivedBy": {
            "type": "string"
          },
          "waiverReason": {
            "type": "string"
          }
        }
      },
      "PKISession": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string"
          },
          "userId": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": ["PENDING", "OTP_SENT", "COMPLETED", "FAILED"]
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "expiresAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "DocuSealSubmission": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": ["pending", "completed", "expired"]
          },
          "signUrl": {
            "type": "string"
          },
          "downloadUrl": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "completedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "CTOSTransaction": {
        "type": "object",
        "properties": {
          "kycSessionId": {
            "type": "string"
          },
          "onboardingId": {
            "type": "string"
          },
          "redirectUrl": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": ["IN_PROGRESS", "COMPLETED", "FAILED"]
          },
          "result": {
            "type": "integer",
            "description": "1 for approved, 0 for rejected"
          }
        }
      },
      "KYCDocument": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "enum": ["front", "back", "selfie"]
          },
          "fileName": {
            "type": "string"
          },
          "fileUrl": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": ["PENDING", "APPROVED", "REJECTED"]
          },
          "uploadedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "BankAccount": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "bankName": {
            "type": "string"
          },
          "accountName": {
            "type": "string"
          },
          "accountNumber": {
            "type": "string"
          },
          "isActive": {
            "type": "boolean"
          },
          "isDefault": {
            "type": "boolean"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "PaymentReceipt": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "repaymentId": {
            "type": "string"
          },
          "receiptNumber": {
            "type": "string"
          },
          "amount": {
            "type": "number"
          },
          "paymentMethod": {
            "type": "string"
          },
          "reference": {
            "type": "string"
          },
          "generatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "downloadUrl": {
            "type": "string"
          }
        }
      },
      "CompanySettings": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "companyName": {
            "type": "string"
          },
          "companyAddress": {
            "type": "string"
          },
          "companyPhone": {
            "type": "string"
          },
          "companyEmail": {
            "type": "string"
          },
          "companyRegistrationNumber": {
            "type": "string"
          },
          "isActive": {
            "type": "boolean"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      }
    }
  },
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "paths": {
    "/api/admin/login": {
      "post": {
        "summary": "Admin login",
        "tags": [
          "Admin"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AdminLogin"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Login successful",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "accessToken": {
                      "type": "string"
                    },
                    "refreshToken": {
                      "type": "string"
                    },
                    "role": {
                      "type": "string",
                      "enum": [
                        "ADMIN",
                        "ATTESTOR"
                      ]
                    },
                    "user": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "phoneNumber": {
                          "type": "string"
                        },
                        "fullName": {
                          "type": "string"
                        },
                        "email": {
                          "type": "string"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid credentials"
          },
          "403": {
            "description": "Access denied, admin or attestor privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/dashboard": {
      "get": {
        "summary": "Get admin dashboard statistics",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Dashboard statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DashboardStats"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/monthly-stats": {
      "get": {
        "summary": "Get monthly statistics for dashboard charts",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Monthly statistics data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "monthlyStats": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "month": {
                            "type": "string"
                          },
                          "applications": {
                            "type": "number"
                          },
                          "approvals": {
                            "type": "number"
                          },
                          "disbursements": {
                            "type": "number"
                          },
                          "revenue": {
                            "type": "number"
                          },
                          "disbursement_amount": {
                            "type": "number"
                          },
                          "disbursement_count": {
                            "type": "number"
                          },
                          "users": {
                            "type": "number"
                          },
                          "kyc_users": {
                            "type": "number"
                          },
                          "actual_repayments": {
                            "type": "number"
                          },
                          "scheduled_repayments": {
                            "type": "number"
                          },
                          "total_loan_value": {
                            "type": "number"
                          },
                          "current_loan_value": {
                            "type": "number"
                          },
                          "repayment_count": {
                            "type": "number"
                          },
                          "scheduled_count": {
                            "type": "number"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/daily-stats": {
      "get": {
        "summary": "Get daily statistics for dashboard charts (last 30 days)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Daily statistics data for the last 30 days",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "dailyStats": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "date": {
                            "type": "string",
                            "format": "date"
                          },
                          "applications": {
                            "type": "number"
                          },
                          "approvals": {
                            "type": "number"
                          },
                          "disbursements": {
                            "type": "number"
                          },
                          "revenue": {
                            "type": "number"
                          },
                          "disbursement_amount": {
                            "type": "number"
                          },
                          "disbursement_count": {
                            "type": "number"
                          },
                          "users": {
                            "type": "number"
                          },
                          "kyc_users": {
                            "type": "number"
                          },
                          "actual_repayments": {
                            "type": "number"
                          },
                          "scheduled_repayments": {
                            "type": "number"
                          },
                          "total_loan_value": {
                            "type": "number"
                          },
                          "current_loan_value": {
                            "type": "number"
                          },
                          "repayment_count": {
                            "type": "number"
                          },
                          "scheduled_count": {
                            "type": "number"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/users": {
      "get": {
        "summary": "Get all users (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of users",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/User"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        },
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer"
            },
            "description": "Number of users to return"
          }
        ]
      }
    },
    "/api/admin/users/{id}": {
      "get": {
        "summary": "Get a specific user by ID (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "User ID"
          }
        ],
        "responses": {
          "200": {
            "description": "User details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "User not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "put": {
        "summary": "Update a user (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "User ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "fullName": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "phoneNumber": {
                    "type": "string"
                  },
                  "role": {
                    "type": "string",
                    "enum": [
                      "USER",
                      "ADMIN"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "User not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "delete": {
        "summary": "Delete a user (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "User ID"
          }
        ],
        "responses": {
          "200": {
            "description": "User deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "User not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/refresh": {
      "post": {
        "summary": "Refresh admin access token",
        "tags": [
          "Admin"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "refreshToken"
                ],
                "properties": {
                  "refreshToken": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "New access token generated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "accessToken": {
                      "type": "string"
                    },
                    "refreshToken": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid refresh token"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/logout": {
      "post": {
        "summary": "Logout admin user",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "refreshToken"
                ],
                "properties": {
                  "refreshToken": {
                    "type": "string",
                    "description": "The refresh token to invalidate"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully logged out",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/me": {
      "get": {
        "summary": "Get admin profile information",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Admin user profile information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "fullName": {
                      "type": "string"
                    },
                    "phoneNumber": {
                      "type": "string"
                    },
                    "email": {
                      "type": "string"
                    },
                    "role": {
                      "type": "string",
                      "enum": [
                        "ADMIN",
                        "ATTESTOR"
                      ]
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden - Not an admin or attestor"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "put": {
        "summary": "Update admin profile information",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "fullName": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "phoneNumber": {
                    "type": "string"
                  },
                  "icNumber": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Admin profile updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "fullName": {
                      "type": "string"
                    },
                    "phoneNumber": {
                      "type": "string"
                    },
                    "email": {
                      "type": "string"
                    },
                    "role": {
                      "type": "string"
                    },
                    "icNumber": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden - Not an admin"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/applications/counts": {
      "get": {
        "summary": "Get counts of loan applications by status (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Counts of loan applications by status",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "INCOMPLETE": {
                      "type": "number"
                    },
                    "PENDING_APP_FEE": {
                      "type": "number"
                    },
                    "PENDING_KYC": {
                      "type": "number"
                    },
                    "PENDING_APPROVAL": {
                      "type": "number"
                    },
                    "APPROVED": {
                      "type": "number"
                    },
                    "PENDING_SIGNATURE": {
                      "type": "number"
                    },
                    "PENDING_DISBURSEMENT": {
                      "type": "number"
                    },
                    "ACTIVE": {
                      "type": "number"
                    },
                    "WITHDRAWN": {
                      "type": "number"
                    },
                    "REJECTED": {
                      "type": "number"
                    },
                    "total": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/applications": {
      "get": {
        "summary": "Get all loan applications (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of loan applications",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LoanApplication"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/applications/live-attestations": {
      "get": {
        "summary": "Get all live video call attestation requests",
        "tags": [
          "Admin - Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of live attestation requests",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LoanApplication"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/applications/{id}/complete-live-attestation": {
      "post": {
        "summary": "Complete live video call attestation for an application",
        "tags": [
          "Admin - Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan application ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "notes": {
                    "type": "string",
                    "description": "Admin notes about the live call"
                  },
                  "meetingCompletedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "When the meeting was completed"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Live attestation completed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or application not in correct status"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/applications/{id}": {
      "get": {
        "summary": "Get a specific loan application (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan application ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Loan application details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/applications/{id}/status": {
      "patch": {
        "summary": "Update loan application status (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan application ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": [
                      "INCOMPLETE",
                      "PENDING_APP_FEE",
                      "PENDING_KYC",
                      "PENDING_APPROVAL",
                      "APPROVED",
                      "DISBURSED",
                      "REJECTED",
                      "WITHDRAWN"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Application status updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "400": {
            "description": "Invalid status value"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/applications/{id}/fresh-offer": {
      "post": {
        "summary": "Submit a fresh offer for a loan application (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan application ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "amount",
                  "term",
                  "interestRate",
                  "monthlyRepayment",
                  "netDisbursement",
                  "originationFee",
                  "legalFee",
                  "applicationFee"
                ],
                "properties": {
                  "amount": {
                    "type": "number",
                    "description": "Fresh offer amount"
                  },
                  "term": {
                    "type": "integer",
                    "description": "Fresh offer term in months"
                  },
                  "interestRate": {
                    "type": "number",
                    "description": "Fresh offer interest rate"
                  },
                  "monthlyRepayment": {
                    "type": "number",
                    "description": "Fresh offer monthly repayment"
                  },
                  "netDisbursement": {
                    "type": "number",
                    "description": "Fresh offer net disbursement amount"
                  },
                  "originationFee": {
                    "type": "number",
                    "description": "Fresh offer origination fee amount"
                  },
                  "legalFee": {
                    "type": "number",
                    "description": "Fresh offer legal fee amount"
                  },
                  "applicationFee": {
                    "type": "number",
                    "description": "Fresh offer application fee amount"
                  },
                  "notes": {
                    "type": "string",
                    "description": "Admin notes for the fresh offer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Fresh offer submitted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or application not in correct status"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/documents/{id}/status": {
      "patch": {
        "summary": "Update document status (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The document ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": [
                      "PENDING",
                      "APPROVED",
                      "REJECTED"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Document status updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Document"
                }
              }
            }
          },
          "400": {
            "description": "Invalid status value"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Document not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/loans": {
      "get": {
        "summary": "Get all approved and disbursed loan applications",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved loans",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/LoanApplication"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized, token is invalid or missing"
          },
          "403": {
            "description": "Forbidden, user is not an admin"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/applications/{id}/disburse": {
      "post": {
        "summary": "Disburse a loan application (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan application ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "notes"
                ],
                "properties": {
                  "notes": {
                    "type": "string",
                    "description": "Additional notes about the disbursement"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Loan successfully disbursed"
          },
          "400": {
            "description": "Invalid request or missing notes"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/ensure-wallets": {
      "post": {
        "summary": "Create wallets for all users if they don't exist (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Wallets created or verified for all users"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/applications/{id}/history": {
      "get": {
        "summary": "Get loan application status history (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan application ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Application history timeline"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/notifications": {
      "get": {
        "summary": "Get all notifications (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": {
              "type": "integer"
            },
            "description": "Page number for pagination"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer"
            },
            "description": "Number of items per page"
          },
          {
            "in": "query",
            "name": "type",
            "schema": {
              "type": "string",
              "enum": [
                "SYSTEM",
                "MARKETING"
              ]
            },
            "description": "Filter by notification type"
          },
          {
            "in": "query",
            "name": "priority",
            "schema": {
              "type": "string",
              "enum": [
                "LOW",
                "MEDIUM",
                "HIGH"
              ]
            },
            "description": "Filter by priority"
          },
          {
            "in": "query",
            "name": "isRead",
            "schema": {
              "type": "boolean"
            },
            "description": "Filter by read status"
          }
        ],
        "responses": {
          "200": {
            "description": "List of all notifications"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/notification-templates": {
      "get": {
        "summary": "Get all notification templates (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of notification templates"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "post": {
        "summary": "Create notification template (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "code",
                  "title",
                  "message",
                  "type"
                ],
                "properties": {
                  "code": {
                    "type": "string"
                  },
                  "title": {
                    "type": "string"
                  },
                  "message": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "SYSTEM",
                      "MARKETING"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Template created successfully"
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/notification-templates/{id}": {
      "put": {
        "summary": "Update notification template (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Template ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "code": {
                    "type": "string"
                  },
                  "title": {
                    "type": "string"
                  },
                  "message": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "SYSTEM",
                      "MARKETING"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Template updated successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "delete": {
        "summary": "Delete notification template (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Template ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Template deleted successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/notification-groups": {
      "get": {
        "summary": "Get all notification groups (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of notification groups"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "post": {
        "summary": "Create notification group (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "filters"
                ],
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "filters": {
                    "type": "object"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Group created successfully"
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/notification-groups/{id}": {
      "put": {
        "summary": "Update notification group (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Group ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "filters": {
                    "type": "object"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Group updated successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Group not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "delete": {
        "summary": "Delete notification group (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Group ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Group deleted successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Group not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/send-notification": {
      "post": {
        "summary": "Send notification to users (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "title",
                  "message",
                  "type",
                  "priority",
                  "recipientType"
                ],
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "message": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "SYSTEM",
                      "MARKETING"
                    ]
                  },
                  "priority": {
                    "type": "string",
                    "enum": [
                      "LOW",
                      "MEDIUM",
                      "HIGH"
                    ]
                  },
                  "link": {
                    "type": "string"
                  },
                  "expiresAt": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "recipientType": {
                    "type": "string",
                    "enum": [
                      "all",
                      "specific",
                      "group"
                    ]
                  },
                  "selectedUsers": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "selectedGroup": {
                    "type": "string"
                  },
                  "templateId": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Notification sent successfully"
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/disbursements": {
      "get": {
        "summary": "Get all loan disbursements (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer"
            },
            "description": "Number of disbursements to return"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer"
            },
            "description": "Number of disbursements to skip"
          },
          {
            "in": "query",
            "name": "status",
            "schema": {
              "type": "string"
            },
            "description": "Filter by disbursement status"
          }
        ],
        "responses": {
          "200": {
            "description": "List of disbursements",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "applicationId": {
                            "type": "string"
                          },
                          "referenceNumber": {
                            "type": "string"
                          },
                          "amount": {
                            "type": "number"
                          },
                          "bankName": {
                            "type": "string"
                          },
                          "bankAccountNumber": {
                            "type": "string"
                          },
                          "disbursedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "disbursedBy": {
                            "type": "string"
                          },
                          "notes": {
                            "type": "string"
                          },
                          "status": {
                            "type": "string"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "application": {
                            "type": "object"
                          }
                        }
                      }
                    },
                    "total": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/loans/{id}/repayments": {
      "get": {
        "summary": "Get loan repayment schedule and history (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Loan repayment data"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Loan not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/repayments/pending": {
      "get": {
        "summary": "Get pending repayment requests (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of pending repayment requests"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/repayments": {
      "get": {
        "summary": "Get all repayment requests with status filter (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "status",
            "schema": {
              "type": "string",
              "enum": [
                "PENDING",
                "APPROVED",
                "REJECTED",
                "all"
              ]
            },
            "description": "Filter by payment status (default is 'all')"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 100
            },
            "description": "Maximum number of results to return"
          }
        ],
        "responses": {
          "200": {
            "description": "List of repayment requests"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/repayments/{id}/approve": {
      "post": {
        "summary": "Approve a pending repayment (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Wallet transaction ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "notes": {
                    "type": "string",
                    "description": "Admin notes for the approval"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Repayment approved successfully"
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Transaction not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/repayments/{id}/reject": {
      "post": {
        "summary": "Reject a pending repayment (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Wallet transaction ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "reason"
                ],
                "properties": {
                  "reason": {
                    "type": "string",
                    "description": "Reason for rejection"
                  },
                  "notes": {
                    "type": "string",
                    "description": "Additional admin notes"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Repayment rejected successfully"
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Transaction not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/loans/sync-balances": {
      "post": {
        "summary": "Sync all loan outstanding balances (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Loan balances synced successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/loans/{id}/transactions": {
      "get": {
        "summary": "Get wallet transactions for a specific loan (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Wallet transactions for the loan",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Loan not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/loans/{id}/request-discharge": {
      "post": {
        "summary": "Request loan discharge (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "reason"
                ],
                "properties": {
                  "reason": {
                    "type": "string",
                    "description": "Reason for requesting discharge"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Discharge request submitted successfully"
          },
          "400": {
            "description": "Invalid request or loan cannot be discharged"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Loan not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/loans/{id}/approve-discharge": {
      "post": {
        "summary": "Approve loan discharge (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan ID"
          }
        ],
        "requestBody": {
          "required": false
        },
        "responses": {
          "200": {
            "description": "Loan discharged successfully"
          },
          "400": {
            "description": "Invalid request or loan cannot be discharged"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Loan not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/loans/{id}/reject-discharge": {
      "post": {
        "summary": "Reject loan discharge request (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "reason"
                ],
                "properties": {
                  "reason": {
                    "type": "string",
                    "description": "Reason for rejecting the discharge"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Discharge request rejected successfully"
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Loan not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/loans/{id}": {
      "get": {
        "summary": "Get individual loan details (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Loan details retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Loan not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/loans/pending-discharge": {
      "get": {
        "summary": "Get loans pending discharge approval (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of loans pending discharge"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/applications/{id}/complete-attestation": {
      "post": {
        "summary": "Mark attestation as completed and move to next stage (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan application ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "attestationType": {
                    "type": "string",
                    "enum": [
                      "IMMEDIATE",
                      "MEETING"
                    ]
                  },
                  "attestationNotes": {
                    "type": "string"
                  },
                  "attestationVideoWatched": {
                    "type": "boolean"
                  },
                  "attestationTermsAccepted": {
                    "type": "boolean"
                  },
                  "meetingCompletedAt": {
                    "type": "string",
                    "format": "date-time"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Attestation completed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or application not in correct status"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/payments/manual": {
      "post": {
        "summary": "Create a manual payment for a loan (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "loanId",
                  "amount",
                  "paymentMethod",
                  "reference"
                ],
                "properties": {
                  "loanId": {
                    "type": "string",
                    "description": "The loan ID to apply payment to"
                  },
                  "amount": {
                    "type": "number",
                    "description": "Payment amount"
                  },
                  "paymentMethod": {
                    "type": "string",
                    "description": "Payment method (e.g., bank_transfer, cash, etc.)"
                  },
                  "reference": {
                    "type": "string",
                    "description": "Payment reference/transaction ID"
                  },
                  "notes": {
                    "type": "string",
                    "description": "Admin notes about the payment"
                  },
                  "paymentDate": {
                    "type": "string",
                    "format": "date",
                    "description": "Date when payment was made (defaults to now)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Payment created and allocated successfully"
          },
          "400": {
            "description": "Invalid request data"
          },
          "404": {
            "description": "Loan not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/payments/csv-upload": {
      "post": {
        "summary": "Upload and process CSV bank transaction file for payment matching (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "csvFile": {
                    "type": "string",
                    "format": "binary",
                    "description": "CSV file containing bank transactions"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "CSV processed successfully with matching results",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "transactions": {
                          "type": "array",
                          "description": "All extracted transactions"
                        },
                        "matches": {
                          "type": "array",
                          "description": "Matched transactions with payments"
                        },
                        "unmatchedTransactions": {
                          "type": "array",
                          "description": "Transactions that couldn't be matched"
                        },
                        "unmatchedPayments": {
                          "type": "array",
                          "description": "Payments that couldn't be matched"
                        },
                        "bankFormat": {
                          "type": "string",
                          "description": "Detected bank format"
                        },
                        "summary": {
                          "type": "object",
                          "description": "Processing summary statistics"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid file or processing error"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/payments/csv-batch-approve": {
      "post": {
        "summary": "Batch approve payments based on CSV transaction matches (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "matches"
                ],
                "properties": {
                  "matches": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "paymentId": {
                          "type": "string",
                          "description": "The payment ID to approve"
                        },
                        "transactionRef": {
                          "type": "string",
                          "description": "Bank transaction reference"
                        },
                        "amount": {
                          "type": "number",
                          "description": "Transaction amount"
                        },
                        "notes": {
                          "type": "string",
                          "description": "Optional approval notes"
                        }
                      }
                    }
                  },
                  "notes": {
                    "type": "string",
                    "description": "General notes for the batch approval"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Batch approval completed"
          },
          "400": {
            "description": "Invalid request data"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/products": {
      "get": {
        "summary": "Get all products (admin only)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of all products",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "code": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string"
                      },
                      "description": {
                        "type": "string"
                      },
                      "interestRate": {
                        "type": "number"
                      },
                      "isActive": {
                        "type": "boolean"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied, admin privileges required"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/admin/applications/pin-sign": {
      "post": {
        "summary": "Sign document with PIN for company/witness (admin and attestor)",
        "tags": [
          "Admin"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "applicationId": {
                    "type": "string"
                  },
                  "signatoryId": {
                    "type": "string"
                  },
                  "pin": {
                    "type": "string"
                  },
                  "signatoryType": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Document signed successfully"
          },
          "400": {
            "description": "Invalid request"
          },
          "403": {
            "description": "Access denied"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/auth/login": {
      "post": {
        "summary": "Login with phone number and password",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "phoneNumber",
                  "password"
                ],
                "properties": {
                  "phoneNumber": {
                    "type": "string",
                    "example": "+1234567890"
                  },
                  "password": {
                    "type": "string",
                    "example": "admin123"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Login successful",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "userId": {
                      "type": "string"
                    },
                    "phoneNumber": {
                      "type": "string"
                    },
                    "accessToken": {
                      "type": "string"
                    },
                    "refreshToken": {
                      "type": "string"
                    },
                    "isOnboardingComplete": {
                      "type": "boolean"
                    },
                    "onboardingStep": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid credentials"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/auth/refresh": {
      "post": {
        "summary": "Refresh access token using refresh token",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "refreshToken"
                ],
                "properties": {
                  "refreshToken": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "New access token generated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "accessToken": {
                      "type": "string"
                    },
                    "refreshToken": {
                      "type": "string"
                    },
                    "isOnboardingComplete": {
                      "type": "boolean"
                    },
                    "onboardingStep": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Invalid refresh token"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/auth/signup": {
      "post": {
        "summary": "Register a new user and send OTP verification",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "phoneNumber",
                  "password"
                ],
                "properties": {
                  "phoneNumber": {
                    "type": "string",
                    "example": "+1234567890"
                  },
                  "password": {
                    "type": "string",
                    "example": "securepassword"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "User created successfully, OTP sent for verification",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "userId": {
                      "type": "string"
                    },
                    "phoneNumber": {
                      "type": "string"
                    },
                    "otpSent": {
                      "type": "boolean"
                    },
                    "expiresAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "User already exists or invalid phone number"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/auth/verify-otp": {
      "post": {
        "summary": "Verify OTP and complete phone number verification",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "phoneNumber",
                  "otp"
                ],
                "properties": {
                  "phoneNumber": {
                    "type": "string",
                    "example": "+1234567890"
                  },
                  "otp": {
                    "type": "string",
                    "example": "123456"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Phone number verified successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "accessToken": {
                      "type": "string"
                    },
                    "refreshToken": {
                      "type": "string"
                    },
                    "userId": {
                      "type": "string"
                    },
                    "phoneNumber": {
                      "type": "string"
                    },
                    "isOnboardingComplete": {
                      "type": "boolean"
                    },
                    "onboardingStep": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired OTP"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/auth/resend-otp": {
      "post": {
        "summary": "Resend OTP verification code",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "phoneNumber"
                ],
                "properties": {
                  "phoneNumber": {
                    "type": "string",
                    "example": "+1234567890"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OTP resent successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "otpSent": {
                      "type": "boolean"
                    },
                    "expiresAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid phone number or rate limit exceeded"
          },
          "404": {
            "description": "User not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/auth/logout": {
      "post": {
        "summary": "Logout a user and invalidate their refresh token",
        "tags": [
          "Auth"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Logged out successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Logged out successfully"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "User not authenticated"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/auth/test-bcrypt": {
      "get": {
        "summary": "Test bcrypt functionality",
        "tags": [
          "Auth"
        ],
        "responses": {
          "200": {
            "description": "Bcrypt test results"
          }
        }
      }
    },
    "/api/auth/forgot-password": {
      "post": {
        "summary": "Initialize password reset flow with OTP",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "phoneNumber"
                ],
                "properties": {
                  "phoneNumber": {
                    "type": "string",
                    "example": "+1234567890"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password reset OTP sent successfully"
          },
          "400": {
            "description": "Invalid phone number"
          },
          "429": {
            "description": "Rate limit exceeded"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/auth/verify-reset-otp": {
      "post": {
        "summary": "Verify password reset OTP",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "phoneNumber",
                  "otp"
                ],
                "properties": {
                  "phoneNumber": {
                    "type": "string"
                  },
                  "otp": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OTP verified successfully"
          },
          "400": {
            "description": "Invalid OTP or phone number"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/auth/reset-password": {
      "post": {
        "summary": "Reset password with verified token",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "resetToken",
                  "newPassword"
                ],
                "properties": {
                  "resetToken": {
                    "type": "string"
                  },
                  "newPassword": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password reset successfully"
          },
          "400": {
            "description": "Invalid token or password"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications": {
      "post": {
        "summary": "Create a new loan application",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "productId",
                  "amount",
                  "term",
                  "purpose"
                ],
                "properties": {
                  "productId": {
                    "type": "string",
                    "description": "ID of the selected loan product"
                  },
                  "amount": {
                    "type": "number",
                    "description": "Loan amount requested"
                  },
                  "term": {
                    "type": "number",
                    "description": "Loan term in months"
                  },
                  "purpose": {
                    "type": "string",
                    "description": "Purpose of the loan"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Loan application created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "404": {
            "description": "Product not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "get": {
        "summary": "Get all loan applications for the current user",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of loan applications retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LoanApplication"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications/{id}": {
      "get": {
        "summary": "Get a loan application by ID or URL link",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID or URL link"
          }
        ],
        "responses": {
          "200": {
            "description": "Loan application retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "404": {
            "description": "Loan application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "patch": {
        "summary": "Update a loan application",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID or URL link"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "amount": {
                    "type": "number",
                    "description": "Updated loan amount"
                  },
                  "term": {
                    "type": "number",
                    "description": "Updated loan term in months"
                  },
                  "purpose": {
                    "type": "string",
                    "description": "Updated loan purpose"
                  },
                  "acceptTerms": {
                    "type": "boolean",
                    "description": "Whether the user has accepted the terms"
                  },
                  "paidAppFee": {
                    "type": "boolean",
                    "description": "Whether the application fee has been paid"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Loan application updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "404": {
            "description": "Loan application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "delete": {
        "summary": "Delete a loan application (only incomplete applications)",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID or URL link"
          }
        ],
        "responses": {
          "200": {
            "description": "Loan application deleted successfully"
          },
          "400": {
            "description": "Cannot delete non-incomplete applications"
          },
          "404": {
            "description": "Loan application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications/{id}/step": {
      "patch": {
        "summary": "Update application step",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID or URL link"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "step"
                ],
                "properties": {
                  "step": {
                    "type": "number",
                    "description": "New application step (0-4)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Application step updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "404": {
            "description": "Loan application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications/{id}/status": {
      "patch": {
        "summary": "Update application status",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID or URL link"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "status"
                ],
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": [
                      "INCOMPLETE",
                      "PENDING",
                      "APPROVED",
                      "REJECTED",
                      "DISBURSED",
                      "CLOSED"
                    ],
                    "description": "New application status"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Application status updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "404": {
            "description": "Loan application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications/{id}/documents": {
      "post": {
        "summary": "Upload documents for a loan application",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "documents": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "format": "binary"
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Documents uploaded successfully"
          },
          "404": {
            "description": "Loan application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "get": {
        "summary": "Get documents for a loan application",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Documents retrieved successfully"
          },
          "404": {
            "description": "Loan application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications/{id}/documents/{documentId}": {
      "patch": {
        "summary": "Update a document's status",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID"
          },
          {
            "in": "path",
            "name": "documentId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Document ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "status"
                ],
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": [
                      "PENDING",
                      "APPROVED",
                      "REJECTED"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Document status updated successfully"
          },
          "404": {
            "description": "Loan application or document not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "delete": {
        "summary": "Delete a document from a loan application",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID"
          },
          {
            "in": "path",
            "name": "documentId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Document ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Document deleted successfully"
          },
          "404": {
            "description": "Loan application or document not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "get": {
        "summary": "Get a specific document for a loan application",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID of the loan application"
          },
          {
            "in": "path",
            "name": "documentId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID of the document to retrieve"
          }
        ],
        "responses": {
          "200": {
            "description": "Document file stream",
            "content": {
              "application/octet-stream": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "403": {
            "description": "Not authorized to access this document"
          },
          "404": {
            "description": "Document or file not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications/{id}/complete-attestation": {
      "post": {
        "summary": "Complete attestation for loan application",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan application ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "attestationType": {
                    "type": "string",
                    "enum": [
                      "IMMEDIATE",
                      "MEETING"
                    ]
                  },
                  "attestationVideoWatched": {
                    "type": "boolean"
                  },
                  "attestationTermsAccepted": {
                    "type": "boolean"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Attestation completed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or application not in correct status"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied - not your application"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications/{id}/history": {
      "get": {
        "summary": "Get loan application status history for current user",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan application ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Application history timeline",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "applicationId": {
                      "type": "string"
                    },
                    "currentStatus": {
                      "type": "string"
                    },
                    "timeline": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "applicationId": {
                            "type": "string"
                          },
                          "previousStatus": {
                            "type": "string"
                          },
                          "newStatus": {
                            "type": "string"
                          },
                          "changedBy": {
                            "type": "string"
                          },
                          "createdAt": {
                            "type": "string"
                          },
                          "notes": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications/{id}/request-live-call": {
      "post": {
        "summary": "Request live video call attestation for loan application",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The loan application ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "attestationType": {
                    "type": "string",
                    "enum": [
                      "MEETING"
                    ]
                  },
                  "reason": {
                    "type": "string",
                    "description": "Optional reason for requesting live call (e.g., \"terms_rejected\")",
                    "example": "terms_rejected"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Live call request submitted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or application not in correct status"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Access denied - not your application"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications/{id}/link-documents": {
      "post": {
        "summary": "Link existing documents to a loan application",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "documentIds",
                  "documentTypes"
                ],
                "properties": {
                  "documentIds": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Array of existing document IDs to link"
                  },
                  "documentTypes": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Array of document types corresponding to the document IDs"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Documents linked successfully"
          },
          "400": {
            "description": "Invalid request data"
          },
          "404": {
            "description": "Loan application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications/{id}/fresh-offer-response": {
      "post": {
        "summary": "Respond to a fresh offer (accept or reject)",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID or URL link"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "action"
                ],
                "properties": {
                  "action": {
                    "type": "string",
                    "enum": [
                      "accept",
                      "reject"
                    ],
                    "description": "User's response to the fresh offer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Fresh offer response recorded successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoanApplication"
                }
              }
            }
          },
          "400": {
            "description": "Invalid action or application not in correct status"
          },
          "404": {
            "description": "Loan application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loan-applications/{id}/kyc-status": {
      "get": {
        "summary": "Check KYC requirements for a loan application",
        "tags": [
          "Loan Applications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan application ID"
          }
        ],
        "responses": {
          "200": {
            "description": "KYC status information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "requiresKyc": {
                      "type": "boolean",
                      "description": "Whether KYC is required"
                    },
                    "hasDocuments": {
                      "type": "boolean",
                      "description": "Whether user has uploaded all KYC documents"
                    },
                    "isKycVerified": {
                      "type": "boolean",
                      "description": "Whether user is KYC verified"
                    },
                    "canProceed": {
                      "type": "boolean",
                      "description": "Whether application can proceed to approval"
                    },
                    "nextStep": {
                      "type": "string",
                      "description": "Next step for the application"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loans": {
      "get": {
        "summary": "Get user's loans",
        "tags": [
          "Loans"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of user's loans (active, pending discharge, and discharged)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "loans": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "principalAmount": {
                            "type": "number"
                          },
                          "outstandingBalance": {
                            "type": "number"
                          },
                          "interestRate": {
                            "type": "number"
                          },
                          "term": {
                            "type": "integer"
                          },
                          "monthlyPayment": {
                            "type": "number"
                          },
                          "nextPaymentDue": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "status": {
                            "type": "string"
                          },
                          "disbursedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "application": {
                            "type": "object",
                            "properties": {
                              "product": {
                                "type": "object",
                                "properties": {
                                  "name": {
                                    "type": "string"
                                  },
                                  "code": {
                                    "type": "string"
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loans/{id}": {
      "get": {
        "summary": "Get specific loan details",
        "tags": [
          "Loans"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Loan details"
          },
          "404": {
            "description": "Loan not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loans/{id}/repayments": {
      "get": {
        "summary": "Get loan repayment history",
        "tags": [
          "Loans"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Loan repayment history",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "repayments": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "amount": {
                            "type": "number"
                          },
                          "principalAmount": {
                            "type": "number"
                          },
                          "interestAmount": {
                            "type": "number"
                          },
                          "status": {
                            "type": "string"
                          },
                          "dueDate": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "paidAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Loan not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loans/receipt/{receiptId}": {
      "get": {
        "summary": "Download receipt PDF by receipt ID (public endpoint for WhatsApp)",
        "tags": [
          "Loans"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "receiptId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Receipt ID"
          },
          {
            "in": "query",
            "name": "phone",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "User's phone number for validation (optional)"
          }
        ],
        "responses": {
          "200": {
            "description": "Receipt PDF file",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "404": {
            "description": "Receipt not found"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/loans/{loanId}/receipts/{receiptId}/download": {
      "get": {
        "summary": "Download receipt PDF for a loan repayment",
        "tags": [
          "Loans"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "loanId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan ID"
          },
          {
            "in": "path",
            "name": "receiptId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Receipt ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Receipt PDF file",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "404": {
            "description": "Receipt not found or access denied"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loans/{id}/transactions": {
      "get": {
        "summary": "Get loan payment transactions from wallet",
        "tags": [
          "Loans"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Loan payment transactions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "walletTransactions": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "amount": {
                            "type": "number"
                          },
                          "type": {
                            "type": "string"
                          },
                          "status": {
                            "type": "string"
                          },
                          "description": {
                            "type": "string"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Loan not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/loans/{id}/late-fees": {
      "get": {
        "summary": "Get late fee information for a loan",
        "tags": [
          "Loans"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Loan ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Late fee information for the loan"
          },
          "404": {
            "description": "Loan not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/mtsa/cert-info/{userId}": {
      "get": {
        "summary": "Get certificate information for a user",
        "tags": [
          "MTSA"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "User ID (IC number)"
          }
        ],
        "responses": {
          "200": {
            "description": "Certificate information retrieved successfully"
          },
          "400": {
            "description": "User ID is required"
          },
          "500": {
            "description": "Failed to get certificate information"
          }
        }
      }
    },
    "/api/mtsa/request-otp": {
      "post": {
        "summary": "Request OTP for certificate enrollment or digital signing",
        "tags": [
          "MTSA"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "userId",
                  "usage"
                ],
                "properties": {
                  "userId": {
                    "type": "string",
                    "description": "User ID (IC number)"
                  },
                  "usage": {
                    "type": "string",
                    "enum": [
                      "DS",
                      "NU"
                    ],
                    "description": "DS for digital signing, NU for new enrollment"
                  },
                  "emailAddress": {
                    "type": "string",
                    "description": "Email address (required for NU)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OTP request sent successfully"
          },
          "400": {
            "description": "Invalid request parameters"
          },
          "500": {
            "description": "Failed to request OTP"
          }
        }
      }
    },
    "/api/mtsa/verify-otp": {
      "post": {
        "summary": "Verify OTP for digital signing",
        "tags": [
          "MTSA"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "userId",
                  "otp"
                ],
                "properties": {
                  "userId": {
                    "type": "string",
                    "description": "User ID (IC number)"
                  },
                  "otp": {
                    "type": "string",
                    "description": "6-digit OTP code"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OTP verification completed"
          },
          "400": {
            "description": "Invalid OTP or missing parameters"
          },
          "500": {
            "description": "Failed to verify OTP"
          }
        }
      }
    },
    "/api/mtsa/request-certificate": {
      "post": {
        "summary": "Request digital certificate enrollment with KYC images",
        "tags": [
          "MTSA"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "userId",
                  "fullName",
                  "emailAddress",
                  "mobileNo",
                  "authFactor",
                  "nricFrontUrl",
                  "nricBackUrl",
                  "selfieImageUrl"
                ],
                "properties": {
                  "userId": {
                    "type": "string",
                    "description": "User ID (IC number)"
                  },
                  "fullName": {
                    "type": "string",
                    "description": "Full name"
                  },
                  "emailAddress": {
                    "type": "string",
                    "description": "Email address"
                  },
                  "mobileNo": {
                    "type": "string",
                    "description": "Mobile number"
                  },
                  "nationality": {
                    "type": "string",
                    "description": "Nationality code (default: MY)"
                  },
                  "userType": {
                    "type": "string",
                    "description": "User type (default: 1)"
                  },
                  "idType": {
                    "type": "string",
                    "description": "ID type (N for NRIC, P for Passport)"
                  },
                  "authFactor": {
                    "type": "string",
                    "description": "OTP code for authentication"
                  },
                  "nricFrontUrl": {
                    "type": "string",
                    "description": "Base64 data URL of NRIC front image"
                  },
                  "nricBackUrl": {
                    "type": "string",
                    "description": "Base64 data URL of NRIC back image"
                  },
                  "selfieImageUrl": {
                    "type": "string",
                    "description": "Base64 data URL of selfie image"
                  },
                  "verificationData": {
                    "type": "object",
                    "description": "Verification metadata"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Certificate request processed successfully"
          },
          "400": {
            "description": "Invalid request parameters or missing KYC images"
          },
          "500": {
            "description": "Failed to request certificate"
          }
        }
      }
    },
    "/api/pki/check-certificate": {
      "post": {
        "summary": "Check PKI certificate status for a user",
        "description": "Checks the PKI certificate status for a user through the signing orchestrator. Users can only check their own certificates for security.",
        "tags": ["PKI"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["userId"],
                "properties": {
                  "userId": {
                    "type": "string",
                    "description": "User ID (typically IC number) to check certificate for",
                    "example": "123456789012"
                  },
                  "submissionId": {
                    "type": "string",
                    "description": "Optional DocuSeal submission ID for context",
                    "example": "sub_123456789"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Certificate status retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Certificate status retrieved successfully"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "certificateExists": {
                          "type": "boolean",
                          "description": "Whether a valid certificate exists for the user"
                        },
                        "status": {
                          "type": "string",
                          "description": "Certificate status",
                          "enum": ["active", "expired", "revoked", "not_found"]
                        },
                        "expiryDate": {
                          "type": "string",
                          "format": "date-time",
                          "description": "Certificate expiry date (if applicable)"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - User ID is required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Access denied - can only check own certificate",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/pki/request-otp": {
      "post": {
        "summary": "Request OTP for PKI signing",
        "description": "Requests an OTP (One-Time Password) for PKI digital signing through the signing orchestrator. The OTP will be sent to the user's registered email or phone.",
        "tags": ["PKI"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["userId", "email"],
                "properties": {
                  "userId": {
                    "type": "string",
                    "description": "User ID (typically IC number) for PKI certificate identification",
                    "example": "123456789012"
                  },
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "User email address for OTP delivery",
                    "example": "user@example.com"
                  },
                  "submissionId": {
                    "type": "string",
                    "description": "Optional DocuSeal submission ID for context",
                    "example": "sub_123456789"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OTP request sent successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "OTP sent successfully"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "otpId": {
                          "type": "string",
                          "description": "OTP session ID for verification",
                          "example": "otp_123456789"
                        },
                        "expiresIn": {
                          "type": "integer",
                          "description": "OTP expiry time in seconds",
                          "example": 300
                        },
                        "deliveryMethod": {
                          "type": "string",
                          "description": "How the OTP was delivered",
                          "enum": ["email", "sms"],
                          "example": "email"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - User ID and email are required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/pki/complete-signing": {
      "post": {
        "summary": "Complete PKI signing with OTP",
        "tags": ["PKI"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["sessionId", "otp"],
                "properties": {
                  "sessionId": {
                    "type": "string",
                    "description": "PKI session ID"
                  },
                  "otp": {
                    "type": "string",
                    "pattern": "^\\d{6}$",
                    "description": "6-digit OTP code"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "PKI signing completed successfully"
          },
          "400": {
            "description": "Session ID and OTP are required or invalid OTP format"
          },
          "500": {
            "description": "Failed to complete PKI signing"
          }
        }
      }
    },
    "/api/pki/sign-pdf": {
      "post": {
        "summary": "Sign PDF with PKI using OTP",
        "tags": ["PKI"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["userId", "otp", "submissionId"],
                "properties": {
                  "userId": {
                    "type": "string",
                    "description": "User ID (IC number)"
                  },
                  "otp": {
                    "type": "string",
                    "pattern": "^\\d{6}$",
                    "description": "6-digit OTP code"
                  },
                  "submissionId": {
                    "type": "string",
                    "description": "DocuSeal submission ID"
                  },
                  "applicationId": {
                    "type": "string",
                    "description": "Loan application ID"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "PDF signed successfully with PKI"
          },
          "400": {
            "description": "Invalid request parameters or OTP format"
          },
          "403": {
            "description": "Access denied: can only sign with own account"
          },
          "404": {
            "description": "User or loan not found"
          },
          "500": {
            "description": "Failed to sign PDF"
          }
        }
      }
    },
    "/api/pki/session/{sessionId}": {
      "get": {
        "summary": "Get PKI session status",
        "tags": ["PKI"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "sessionId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "PKI session ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Session status retrieved successfully"
          },
          "400": {
            "description": "Session ID is required"
          },
          "500": {
            "description": "Failed to get session status"
          }
        }
      }
    },
    "/api/docuseal/initiate-loan-signing": {
      "post": {
        "summary": "Initiate document signing for a loan",
        "description": "Creates a DocuSeal submission for loan agreement signing. The loan must be in APPROVED status. When the form is completed, it triggers PKI signing workflow through the signing orchestrator with additional parameters including user details, submission IDs, and signatory information.",
        "tags": ["DocuSeal"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["loanId"],
                "properties": {
                  "loanId": {
                    "type": "string",
                    "description": "The ID of the approved loan to initiate signing for",
                    "example": "cm123abc456def789"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Document signing initiated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Document signing initiated successfully"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "submissionId": {
                          "type": "string",
                          "description": "DocuSeal submission ID",
                          "example": "sub_123456789"
                        },
                        "signUrl": {
                          "type": "string",
                          "description": "URL for the borrower to sign the document",
                          "example": "https://docuseal.co/s/abc123def456"
                        },
                        "status": {
                          "type": "string",
                          "description": "Current submission status",
                          "enum": ["pending", "completed", "expired"],
                          "example": "pending"
                        }
                      }

                    },
                    "pkiIntegration": {
                      "type": "object",
                      "description": "PKI signing integration details (passed to signing orchestrator on form completion)",
                      "properties": {
                        "note": {
                          "type": "string",
                          "description": "When the DocuSeal form is completed, the following parameters are automatically forwarded to the signing orchestrator for PKI processing"
                        },
                        "orchestratorParams": {
                          "type": "object",
                          "description": "Parameters forwarded to signing orchestrator",
                          "properties": {
                            "userId": {
                              "type": "string",
                              "description": "User IC number for MTSA PKI signing"
                            },
                            "vpsUserId": {
                              "type": "string", 
                              "description": "VPS database user ID"
                            },
                            "submissionId": {
                              "type": "string",
                              "description": "DocuSeal submission ID"
                            },
                            "docusealSubmitterId": {
                              "type": "string",
                              "description": "DocuSeal submitter ID"
                            },
                            "userFullName": {
                              "type": "string",
                              "description": "User's full name from database"
                            },
                            "applicationId": {
                              "type": "string",
                              "description": "Loan application ID"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - missing loanId or loan not in correct status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Loan not found or access denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/docuseal/initiate-application-signing": {
      "post": {
        "summary": "Initiate document signing for a loan application",
        "description": "Creates a DocuSeal submission for loan application signing. The application must be in PENDING_SIGNATURE status. If a submission already exists, returns the existing signing URL.",
        "tags": ["DocuSeal"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["applicationId"],
                "properties": {
                  "applicationId": {
                    "type": "string",
                    "description": "The ID of the loan application in PENDING_SIGNATURE status",
                    "example": "app_123abc456def789"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Document signing initiated successfully or existing submission retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Document signing initiated successfully"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "submissionId": {
                          "type": "string",
                          "description": "DocuSeal submission ID",
                          "example": "sub_123456789"
                        },
                        "signUrl": {
                          "type": "string",
                          "description": "URL for the applicant to sign the document",
                          "example": "https://docuseal.co/s/abc123def456"
                        },
                        "status": {
                          "type": "string",
                          "description": "Current submission status",
                          "enum": ["pending", "completed", "expired"],
                          "example": "pending"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - missing applicationId or application not in PENDING_SIGNATURE status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Application not found or access denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/docuseal/submission/{submissionId}": {
      "get": {
        "summary": "Get DocuSeal submission status",
        "tags": ["DocuSeal"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "submissionId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "DocuSeal submission ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Submission status retrieved successfully"
          },
          "500": {
            "description": "Failed to get submission status"
          }
        }
      }
    },
    "/api/docuseal/webhook": {
      "post": {
        "summary": "Handle DocuSeal webhook events",
        "description": "Processes DocuSeal webhook events. When event_type is 'form.completed', the webhook is intercepted and forwarded to the signing orchestrator for PKI processing with additional parameters (userId, vpsUserId, submissionId, docusealSubmitterId, userFullName, applicationId).",
        "tags": ["DocuSeal"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "event_type": {
                    "type": "string",
                    "description": "Type of webhook event"
                  },
                  "data": {
                    "type": "object",
                    "description": "Event data payload"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Webhook processed successfully"
          },
          "401": {
            "description": "Invalid signature"
          },
          "500": {
            "description": "Failed to process webhook"
          }
        }
      }
    },
    "/api/docuseal/download/{submissionId}": {
      "get": {
        "summary": "Download signed agreement document",
        "tags": ["DocuSeal"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "submissionId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "DocuSeal submission ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Download URL retrieved successfully"
          },
          "400": {
            "description": "Submission ID is required or agreement is not yet signed"
          },
          "404": {
            "description": "Agreement not found or access denied"
          },
          "500": {
            "description": "Failed to download agreement"
          }
        }
      }
    },
    "/api/ctos/create-transaction": {
      "post": {
        "summary": "Create CTOS eKYC transaction",
        "description": "Creates a new CTOS eKYC transaction for identity verification. This initiates the KYC process and returns a transaction URL for the user to complete verification.",
        "tags": ["CTOS"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["userId", "documentName", "documentNumber"],
                "properties": {
                  "userId": {
                    "type": "string",
                    "description": "The ID of the user to create KYC transaction for",
                    "example": "user_123abc456def789"
                  },
                  "documentName": {
                    "type": "string",
                    "description": "Type of identity document",
                    "enum": ["NRIC", "Passport", "MyKad"],
                    "example": "NRIC"
                  },
                  "documentNumber": {
                    "type": "string",
                    "description": "The identity document number",
                    "example": "123456789012"
                  },
                  "platform": {
                    "type": "string",
                    "enum": ["Web", "iOS", "Android"],
                    "default": "Web",
                    "description": "Platform where KYC will be completed",
                    "example": "Web"
                  },
                  "responseUrl": {
                    "type": "string",
                    "format": "uri",
                    "description": "Optional callback URL for completion notification",
                    "example": "https://app.kredit.my/kyc/callback"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "CTOS transaction created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "CTOS transaction created successfully"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "kycSessionId": {
                          "type": "string",
                          "description": "KYC session ID for tracking",
                          "example": "kyc_123456789"
                        },
                        "transactionId": {
                          "type": "string",
                          "description": "CTOS transaction ID",
                          "example": "ctos_987654321"
                        },
                        "verificationUrl": {
                          "type": "string",
                          "description": "URL for user to complete KYC verification",
                          "example": "https://ctos.com.my/verify/abc123def456"
                        },
                        "status": {
                          "type": "string",
                          "description": "Current transaction status",
                          "enum": ["IN_PROGRESS", "COMPLETED", "FAILED"],
                          "example": "IN_PROGRESS"
                        },
                        "expiresAt": {
                          "type": "string",
                          "format": "date-time",
                          "description": "Transaction expiry time"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "User not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/ctos/status/{kycSessionId}": {
      "get": {
        "summary": "Get CTOS eKYC transaction status",
        "tags": ["CTOS"],
        "parameters": [
          {
            "in": "path",
            "name": "kycSessionId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "KYC session ID"
          }
        ],
        "responses": {
          "200": {
            "description": "CTOS status retrieved successfully"
          },
          "404": {
            "description": "KYC session not found"
          },
          "500": {
            "description": "Failed to get CTOS status"
          }
        }
      }
    },
    "/api/ctos/webhook": {
      "post": {
        "summary": "Handle CTOS webhook callbacks",
        "tags": ["CTOS"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "ref_id": {
                    "type": "string",
                    "description": "Reference ID (user ID)"
                  },
                  "onboarding_id": {
                    "type": "string",
                    "description": "CTOS onboarding ID"
                  },
                  "result": {
                    "type": "integer",
                    "description": "Result code (1=approved, 0=rejected)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Webhook processed successfully"
          },
          "500": {
            "description": "Failed to process webhook"
          }
        }
      }
    },
    "/api/kyc/start-ctos": {
      "post": {
        "summary": "Start CTOS eKYC process",
        "tags": ["KYC"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["documentName", "documentNumber"],
                "properties": {
                  "applicationId": {
                    "type": "string",
                    "description": "Loan application ID"
                  },
                  "documentName": {
                    "type": "string",
                    "description": "Document name (e.g., NRIC, Passport)"
                  },
                  "documentNumber": {
                    "type": "string",
                    "description": "Document number"
                  },
                  "platform": {
                    "type": "string",
                    "enum": ["Web", "iOS", "Android"],
                    "default": "Web",
                    "description": "Platform type"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "CTOS eKYC process started successfully"
          },
          "400": {
            "description": "Document name and number are required"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Failed to start CTOS eKYC"
          }
        }
      }
    },
    "/api/kyc/upload": {
      "post": {
        "summary": "Upload KYC documents",
        "tags": ["KYC"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "KYC document file"
                  },
                  "type": {
                    "type": "string",
                    "enum": ["front", "back", "selfie"],
                    "description": "Document type"
                  },
                  "applicationId": {
                    "type": "string",
                    "description": "Loan application ID"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Document uploaded successfully"
          },
          "400": {
            "description": "Invalid file type or missing parameters"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Failed to upload document"
          }
        }
      }
    },
    "/api/kyc/status": {
      "get": {
        "summary": "Get KYC status for authenticated user",
        "tags": ["KYC"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "KYC status retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Failed to get KYC status"
          }
        }
      }
    },
    "/api/bank-accounts": {
      "get": {
        "summary": "Get all bank accounts (Admin only)",
        "tags": ["Bank Accounts"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of bank accounts retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "500": {
            "description": "Failed to get bank accounts"
          }
        }
      },
      "post": {
        "summary": "Create new bank account (Admin only)",
        "tags": ["Bank Accounts"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["bankName", "accountName", "accountNumber"],
                "properties": {
                  "bankName": {
                    "type": "string",
                    "description": "Bank name"
                  },
                  "accountName": {
                    "type": "string",
                    "description": "Account holder name"
                  },
                  "accountNumber": {
                    "type": "string",
                    "description": "Bank account number"
                  },
                  "isActive": {
                    "type": "boolean",
                    "description": "Whether account is active"
                  },
                  "isDefault": {
                    "type": "boolean",
                    "description": "Whether this is the default account"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Bank account created successfully"
          },
          "400": {
            "description": "Invalid request parameters"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "500": {
            "description": "Failed to create bank account"
          }
        }
      }
    },
    "/api/bank-accounts/default": {
      "get": {
        "summary": "Get default/active bank account",
        "tags": ["Bank Accounts"],
        "responses": {
          "200": {
            "description": "Default bank account retrieved successfully"
          },
          "404": {
            "description": "No default bank account found"
          },
          "500": {
            "description": "Failed to get default bank account"
          }
        }
      }
    },
    "/api/receipts": {
      "get": {
        "summary": "List all receipts with pagination (Admin only)",
        "tags": ["Receipts"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": {
              "type": "integer",
              "default": 1
            },
            "description": "Page number"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 10
            },
            "description": "Items per page"
          }
        ],
        "responses": {
          "200": {
            "description": "List of receipts retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "500": {
            "description": "Failed to get receipts"
          }
        }
      }
    },
    "/api/receipts/generate": {
      "post": {
        "summary": "Generate a receipt for a specific repayment (Admin only)",
        "tags": ["Receipts"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["repaymentId"],
                "properties": {
                  "repaymentId": {
                    "type": "string",
                    "description": "Loan repayment ID"
                  },
                  "paymentMethod": {
                    "type": "string",
                    "description": "Payment method used"
                  },
                  "reference": {
                    "type": "string",
                    "description": "Payment reference number"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Receipt generated successfully"
          },
          "400": {
            "description": "Invalid request parameters"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "404": {
            "description": "Repayment not found"
          },
          "500": {
            "description": "Failed to generate receipt"
          }
        }
      }
    },
    "/api/receipts/{receiptId}/download": {
      "get": {
        "summary": "Download a receipt PDF (Admin only)",
        "tags": ["Receipts"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "receiptId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Receipt ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Receipt PDF downloaded successfully",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "404": {
            "description": "Receipt not found"
          },
          "500": {
            "description": "Failed to download receipt"
          }
        }
      }
    },
    "/api/companySettings": {
      "get": {
        "summary": "Get current company settings (Admin only)",
        "tags": ["Company Settings"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Company settings retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "500": {
            "description": "Failed to get company settings"
          }
        }
      },
      "post": {
        "summary": "Create or update company settings (Admin only)",
        "tags": ["Company Settings"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "companyName": {
                    "type": "string",
                    "description": "Company name"
                  },
                  "companyAddress": {
                    "type": "string",
                    "description": "Company address"
                  },
                  "companyPhone": {
                    "type": "string",
                    "description": "Company phone number"
                  },
                  "companyEmail": {
                    "type": "string",
                    "format": "email",
                    "description": "Company email"
                  },
                  "companyRegistrationNumber": {
                    "type": "string",
                    "description": "Company registration number"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Company settings updated successfully"
          },
          "201": {
            "description": "Company settings created successfully"
          },
          "400": {
            "description": "Invalid request parameters"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "500": {
            "description": "Failed to update company settings"
          }
        }
      }
    },
    "/api/onboarding": {
      "get": {
        "summary": "Get user onboarding status",
        "tags": ["Onboarding"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Onboarding status retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Failed to get onboarding status"
          }
        }
      },
      "post": {
        "summary": "Update user onboarding information",
        "tags": ["Onboarding"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "step": {
                    "type": "integer",
                    "description": "Current onboarding step"
                  },
                  "data": {
                    "type": "object",
                    "description": "Onboarding step data"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Onboarding information updated successfully"
          },
          "400": {
            "description": "Invalid request parameters"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Failed to update onboarding information"
          }
        }
      }
    },
    "/api/admin/early-settlement/pending": {
      "get": {
        "summary": "Get pending early settlement requests (Admin/Attestor only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": {
              "type": "integer",
              "default": 1
            },
            "description": "Page number"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 10
            },
            "description": "Items per page"
          },
          {
            "in": "query",
            "name": "search",
            "schema": {
              "type": "string"
            },
            "description": "Search term"
          }
        ],
        "responses": {
          "200": {
            "description": "Pending early settlement requests retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin/Attestor access required"
          },
          "500": {
            "description": "Failed to get early settlement requests"
          }
        }
      }
    },
    "/api/admin/early-settlement/{transactionId}": {
      "get": {
        "summary": "Get early settlement request details (Admin/Attestor only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "transactionId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Early settlement transaction ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Early settlement request details retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin/Attestor access required"
          },
          "404": {
            "description": "Early settlement request not found"
          },
          "500": {
            "description": "Failed to get early settlement request details"
          }
        }
      }
    },
    "/api/admin/early-settlement/{transactionId}/approve": {
      "post": {
        "summary": "Approve early settlement request (Admin/Attestor only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "transactionId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Early settlement transaction ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "notes": {
                    "type": "string",
                    "description": "Admin notes for approval"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Early settlement request approved successfully"
          },
          "400": {
            "description": "Invalid request or settlement already processed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin/Attestor access required"
          },
          "404": {
            "description": "Early settlement request not found"
          },
          "500": {
            "description": "Failed to approve early settlement request"
          }
        }
      }
    },
    "/api/admin/early-settlement/{transactionId}/reject": {
      "post": {
        "summary": "Reject early settlement request (Admin/Attestor only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "transactionId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Early settlement transaction ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["reason"],
                "properties": {
                  "reason": {
                    "type": "string",
                    "description": "Reason for rejection"
                  },
                  "notes": {
                    "type": "string",
                    "description": "Additional admin notes"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Early settlement request rejected successfully"
          },
          "400": {
            "description": "Invalid request or settlement already processed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin/Attestor access required"
          },
          "404": {
            "description": "Early settlement request not found"
          },
          "500": {
            "description": "Failed to reject early settlement request"
          }
        }
      }
    },
    "/api/admin/late-fees": {
      "get": {
        "summary": "Get all repayments with late fees (Admin only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": {
              "type": "integer",
              "default": 1
            },
            "description": "Page number"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 10
            },
            "description": "Items per page"
          }
        ],
        "responses": {
          "200": {
            "description": "Repayments with late fees retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "500": {
            "description": "Failed to get late fees data"
          }
        }
      }
    },
    "/api/admin/late-fees/status": {
      "get": {
        "summary": "Get late fee processing status (Admin only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Late fee processing status retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "500": {
            "description": "Failed to get processing status"
          }
        }
      }
    },
    "/api/admin/late-fees/process": {
      "post": {
        "summary": "Manually trigger late fee processing (Admin only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Late fee processing triggered successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "500": {
            "description": "Failed to trigger late fee processing"
          }
        }
      }
    },
    "/api/admin/late-fees/repayment/{repaymentId}": {
      "get": {
        "summary": "Get late fee summary for a specific repayment (Admin only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "repaymentId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Repayment ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Late fee summary retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "404": {
            "description": "Repayment not found"
          },
          "500": {
            "description": "Failed to get late fee summary"
          }
        }
      }
    },
    "/api/admin/late-fees/repayment/{repaymentId}/total-due": {
      "get": {
        "summary": "Get total amount due for a repayment including late fees (Admin only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "repaymentId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Repayment ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Total amount due retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "404": {
            "description": "Repayment not found"
          },
          "500": {
            "description": "Failed to get total amount due"
          }
        }
      }
    },
    "/api/admin/late-fees/repayment/{repaymentId}/handle-payment": {
      "post": {
        "summary": "Manually handle late fee payment for a repayment (Admin only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "repaymentId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Repayment ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["amount"],
                "properties": {
                  "amount": {
                    "type": "number",
                    "description": "Payment amount"
                  },
                  "notes": {
                    "type": "string",
                    "description": "Payment notes"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Late fee payment handled successfully"
          },
          "400": {
            "description": "Invalid payment amount"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "404": {
            "description": "Repayment not found"
          },
          "500": {
            "description": "Failed to handle late fee payment"
          }
        }
      }
    },
    "/api/admin/late-fees/repayment/{repaymentId}/waive": {
      "post": {
        "summary": "Manually waive late fees for a specific repayment (Admin only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "repaymentId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Repayment ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["reason"],
                "properties": {
                  "reason": {
                    "type": "string",
                    "description": "Reason for waiving late fees"
                  },
                  "amount": {
                    "type": "number",
                    "description": "Amount to waive (optional, defaults to all outstanding late fees)"
                  },
                  "notes": {
                    "type": "string",
                    "description": "Additional notes"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Late fees waived successfully"
          },
          "400": {
            "description": "Invalid request or no late fees to waive"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "404": {
            "description": "Repayment not found"
          },
          "500": {
            "description": "Failed to waive late fees"
          }
        }
      }
    },
    "/api/admin/late-fees/logs": {
      "get": {
        "summary": "Get recent late fee processing logs (Admin only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "default": 50
            },
            "description": "Number of logs to retrieve"
          }
        ],
        "responses": {
          "200": {
            "description": "Processing logs retrieved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "500": {
            "description": "Failed to get processing logs"
          }
        }
      }
    },
    "/api/admin/late-fees/alerts": {
      "delete": {
        "summary": "Clear late fee alerts (Admin only)",
        "tags": ["Admin"],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Alerts cleared successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          },
          "500": {
            "description": "Failed to clear alerts"
          }
        }
      }
    },
    "/api/notifications": {
      "get": {
        "summary": "Get user's notifications",
        "tags": [
          "Notifications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": {
              "type": "integer"
            },
            "description": "Page number for pagination"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer"
            },
            "description": "Number of items per page"
          }
        ],
        "responses": {
          "200": {
            "description": "List of notifications"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "patch": {
        "summary": "Mark notifications as read",
        "tags": [
          "Notifications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "notificationIds"
                ],
                "properties": {
                  "notificationIds": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Notifications marked as read"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/notifications/{id}": {
      "delete": {
        "summary": "Delete a notification",
        "tags": [
          "Notifications"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The notification ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Notification deleted successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Notification not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/products": {
      "get": {
        "summary": "Get all active products or a specific product by code",
        "tags": [
          "Products"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "code",
            "schema": {
              "type": "string"
            },
            "description": "Product code to filter by"
          }
        ],
        "responses": {
          "200": {
            "description": "List of active products or a single product if code is provided",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Product"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Product not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "post": {
        "summary": "Create a new product",
        "tags": [
          "Products"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProductInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Product created successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/products/{id}": {
      "patch": {
        "summary": "Update a product",
        "tags": [
          "Products"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Product ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProductInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Product updated successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Product not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "delete": {
        "summary": "Delete a product",
        "tags": [
          "Products"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Product ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Product deleted successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Product not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "get": {
        "summary": "Get a product by ID",
        "tags": [
          "Products"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Product ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Product details"
          },
          "404": {
            "description": "Product not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/settings": {
      "get": {
        "summary": "Get all system settings (admin only)",
        "tags": [
          "Settings"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "System settings retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "key": {
                            "type": "string"
                          },
                          "category": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "description": {
                            "type": "string"
                          },
                          "dataType": {
                            "type": "string"
                          },
                          "value": {
                            "type": "string"
                          },
                          "options": {
                            "type": "object"
                          },
                          "isActive": {
                            "type": "boolean"
                          },
                          "requiresRestart": {
                            "type": "boolean"
                          },
                          "affectsExistingLoans": {
                            "type": "boolean"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          }
        }
      },
      "put": {
        "summary": "Update multiple system settings (admin only)",
        "tags": [
          "Settings"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "settings": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "key": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      }
                    }
                  }
                },
                "example": {
                  "settings": [
                    {
                      "key": "LOAN_CALCULATION_METHOD",
                      "value": "RULE_OF_78"
                    },
                    {
                      "key": "PAYMENT_SCHEDULE_TYPE",
                      "value": "FIRST_OF_MONTH"
                    }
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Settings updated successfully"
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Admin access required"
          }
        }
      }
    },
    "/api/settings/categories": {
      "get": {
        "summary": "Get settings grouped by category (admin only)",
        "tags": [
          "Settings"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Settings categories retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "object",
                      "additionalProperties": {
                        "type": "array",
                        "items": {
                          "type": "object"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/settings/{key}": {
      "get": {
        "summary": "Get a specific setting by key",
        "tags": [
          "Settings"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "key",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Setting retrieved successfully"
          },
          "404": {
            "description": "Setting not found"
          }
        }
      },
      "put": {
        "summary": "Update a specific setting (admin only)",
        "tags": [
          "Settings"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "key",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string"
                  }
                },
                "example": {
                  "value": "RULE_OF_78"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Setting updated successfully"
          },
          "400": {
            "description": "Invalid input"
          },
          "404": {
            "description": "Setting not found"
          }
        }
      }
    },
    "/api/users/me": {
      "get": {
        "summary": "Get current user information",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "User information retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "phoneNumber": {
                      "type": "string"
                    },
                    "fullName": {
                      "type": "string"
                    },
                    "email": {
                      "type": "string"
                    },
                    "dateOfBirth": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "address1": {
                      "type": "string"
                    },
                    "address2": {
                      "type": "string"
                    },
                    "city": {
                      "type": "string"
                    },
                    "state": {
                      "type": "string"
                    },
                    "postalCode": {
                      "type": "string"
                    },
                    "employmentStatus": {
                      "type": "string"
                    },
                    "employerName": {
                      "type": "string"
                    },
                    "monthlyIncome": {
                      "type": "string"
                    },
                    "bankName": {
                      "type": "string"
                    },
                    "accountNumber": {
                      "type": "string"
                    },
                    "icNumber": {
                      "type": "string"
                    },
                    "icType": {
                      "type": "string"
                    },
                    "emergencyContactName": {
                      "type": "string"
                    },
                    "emergencyContactPhone": {
                      "type": "string"
                    },
                    "emergencyContactRelationship": {
                      "type": "string"
                    },
                    "isOnboardingComplete": {
                      "type": "boolean"
                    },
                    "onboardingStep": {
                      "type": "number"
                    },
                    "kycStatus": {
                      "type": "string"
                    },
                    "lastLoginAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "serviceLength": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - No token provided"
          },
          "403": {
            "description": "Forbidden - Invalid token"
          },
          "404": {
            "description": "User not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      },
      "put": {
        "summary": "Update current user information",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "fullName": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "dateOfBirth": {
                    "type": "string",
                    "format": "date"
                  },
                  "address1": {
                    "type": "string"
                  },
                  "address2": {
                    "type": "string"
                  },
                  "city": {
                    "type": "string"
                  },
                  "state": {
                    "type": "string"
                  },
                  "postalCode": {
                    "type": "string"
                  },
                  "employmentStatus": {
                    "type": "string"
                  },
                  "employerName": {
                    "type": "string"
                  },
                  "monthlyIncome": {
                    "type": "string"
                  },
                  "bankName": {
                    "type": "string"
                  },
                  "accountNumber": {
                    "type": "string"
                  },
                  "icNumber": {
                    "type": "string"
                  },
                  "icType": {
                    "type": "string"
                  },
                  "emergencyContactName": {
                    "type": "string"
                  },
                  "emergencyContactPhone": {
                    "type": "string"
                  },
                  "emergencyContactRelationship": {
                    "type": "string"
                  },
                  "serviceLength": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User information updated successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/users/me/password": {
      "put": {
        "summary": "Change user password",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "currentPassword",
                  "newPassword"
                ],
                "properties": {
                  "currentPassword": {
                    "type": "string",
                    "description": "Current password for verification"
                  },
                  "newPassword": {
                    "type": "string",
                    "description": "New password to set"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password changed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid input or password requirements not met"
          },
          "401": {
            "description": "Unauthorized or current password incorrect"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/users/me/documents": {
      "get": {
        "summary": "Get all documents for the current user",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "User documents retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "type": {
                        "type": "string"
                      },
                      "status": {
                        "type": "string"
                      },
                      "fileUrl": {
                        "type": "string"
                      },
                      "applicationId": {
                        "type": "string"
                      },
                      "createdAt": {
                        "type": "string",
                        "format": "date-time"
                      },
                      "updatedAt": {
                        "type": "string",
                        "format": "date-time"
                      },
                      "application": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "product": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string"
                              },
                              "code": {
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - No token provided"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/users/me/phone/change-request": {
      "post": {
        "summary": "Request phone number change",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "newPhoneNumber"
                ],
                "properties": {
                  "newPhoneNumber": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Phone change request initiated"
          },
          "400": {
            "description": "Invalid phone number or already in use"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/users/me/phone/verify-current": {
      "post": {
        "summary": "Verify current phone for phone change",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "changeToken",
                  "otp"
                ],
                "properties": {
                  "changeToken": {
                    "type": "string"
                  },
                  "otp": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Current phone verified, OTP sent to new phone"
          },
          "400": {
            "description": "Invalid token or OTP"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/api/users/me/phone/verify-new": {
      "post": {
        "summary": "Verify new phone and complete phone change",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "changeToken",
                  "otp"
                ],
                "properties": {
                  "changeToken": {
                    "type": "string"
                  },
                  "otp": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Phone number changed successfully"
          },
          "400": {
            "description": "Invalid token or OTP"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "Admin",
      "description": "API endpoints for Admin dashboard"
    },
    {
      "name": "Auth",
      "description": "API endpoints for managing user authentication"
    },
    {
      "name": "Loan Applications",
      "description": "API endpoints for managing loan applications"
    },
    {
      "name": "Loans",
      "description": "API endpoints for managing user loans"
    },
    {
      "name": "MTSA",
      "description": "MyTrustSigner Agent integration for digital certificates and OTP"
    },
    {
      "name": "PKI",
      "description": "PKI digital signing integration for loan agreements"
    },
    {
      "name": "DocuSeal",
      "description": "DocuSeal document signing integration"
    },
    {
      "name": "CTOS",
      "description": "CTOS eKYC integration for identity verification"
    },
    {
      "name": "KYC",
      "description": "Know Your Customer document verification"
    },
    {
      "name": "Wallet",
      "description": "User wallet and transaction management"
    },
    {
      "name": "Bank Accounts",
      "description": "Bank account management for loan disbursements"
    },
    {
      "name": "Receipts",
      "description": "Payment receipt generation and management"
    },
    {
      "name": "Company Settings",
      "description": "Company configuration and settings management"
    },
    {
      "name": "Onboarding",
      "description": "User onboarding process management"
    },
    {
      "name": "Products",
      "description": "API endpoints for managing loan products"
    },
    {
      "name": "Users",
      "description": "API endpoints for managing logged-in user's data"
    }
  ]
}