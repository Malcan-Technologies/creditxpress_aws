# CreditXpress API Endpoints - Penetration Testing Reference

## Overview
This document lists all API endpoints for the CreditXpress platform for penetration testing purposes. The platform consists of:
- **VPS Backend**: Main application API (api.creditxpress.com.my)
- **Signing Orchestrator**: On-premises signing service (sign.creditxpress.com.my)

---

## üåê VPS Backend APIs (api.creditxpress.com.my)

### Authentication & User Management

#### Auth Endpoints
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/auth/login` | User login with phone/password | No |
| POST | `/api/auth/register` | User registration | No |
| POST | `/api/auth/refresh` | Refresh access token | No |
| POST | `/api/auth/logout` | User logout | Yes |
| POST | `/api/auth/forgot-password` | Request password reset | No |
| POST | `/api/auth/reset-password` | Reset password with token | No |
| POST | `/api/auth/verify-phone` | Verify phone number with OTP | No |
| POST | `/api/auth/resend-otp` | Resend OTP | No |

#### User Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/users/me` | Get current user profile | Yes |
| PUT | `/api/users/me` | Update user profile | Yes |
| POST | `/api/users/change-phone` | Request phone number change | Yes |
| POST | `/api/users/verify-phone-change` | Verify phone change with OTP | Yes |

### Onboarding & KYC

#### Onboarding
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/onboarding/step` | Get current onboarding step | Yes |
| POST | `/api/onboarding/personal-info` | Submit personal information | Yes |
| POST | `/api/onboarding/employment-info` | Submit employment information | Yes |
| POST | `/api/onboarding/bank-info` | Submit bank information | Yes |
| POST | `/api/onboarding/complete` | Complete onboarding | Yes |

#### KYC (Know Your Customer)
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/kyc/status` | Get KYC status | Yes |
| POST | `/api/kyc/documents` | Upload KYC documents | Yes |
| GET | `/api/kyc/documents` | Get uploaded documents | Yes |
| POST | `/api/kyc/face-verification` | Submit face verification | Yes |
| POST | `/api/kyc/liveness-check` | Submit liveness check | Yes |

### Products & Loan Applications

#### Products
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/products` | Get all active products | No |
| GET | `/api/products?code={code}` | Get specific product by code | No |

#### Loan Applications
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/loan-applications` | Get user's loan applications | Yes |
| POST | `/api/loan-applications` | Create new loan application | Yes |
| GET | `/api/loan-applications/:id` | Get specific application | Yes |
| PUT | `/api/loan-applications/:id` | Update application | Yes |
| POST | `/api/loan-applications/:id/documents` | Upload application documents | Yes |
| GET | `/api/loan-applications/:id/documents` | Get application documents | Yes |
| POST | `/api/loan-applications/:id/submit` | Submit application for review | Yes |

### Loans & Repayments

#### Loans
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/loans` | Get user's active loans | Yes |
| GET | `/api/loans/:id` | Get specific loan details | Yes |
| GET | `/api/loans/:id/repayments` | Get loan repayment schedule | Yes |
| GET | `/api/loans/:id/transactions` | Get loan transaction history | Yes |
| GET | `/api/loans/:id/late-fees` | Get loan late fees | Yes |
| POST | `/api/loans/:id/early-settlement/quote` | Get early settlement quote | Yes |
| POST | `/api/loans/:id/early-settlement/request` | Request early settlement | Yes |
| GET | `/api/loans/:loanId/download-agreement` | Download loan agreement | Yes |
| GET | `/api/loans/:loanId/download-stamped-agreement` | Download stamped agreement | Yes |
| GET | `/api/loans/:loanId/download-stamp-certificate` | Download stamp certificate | Yes |

#### Receipts
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/loans/receipt/:receiptId` | Get payment receipt | No |
| GET | `/api/loans/:loanId/receipts/:receiptId/download` | Download receipt PDF | Yes |

### Wallet & Payments

#### Wallet
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/wallet` | Get wallet balance and info | Yes |
| GET | `/api/wallet/transactions` | Get wallet transaction history | Yes |
| POST | `/api/wallet/deposit` | Deposit funds to wallet | Yes |
| POST | `/api/wallet/withdraw` | Withdraw funds from wallet | Yes |
| POST | `/api/wallet/repay-loan` | Repay loan from wallet | Yes |
| PATCH | `/api/wallet/transactions/:id/process` | Process pending transaction | Yes |

### Bank Accounts
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/bank-accounts` | Get supported bank accounts | No |

### Notifications
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/notifications` | Get user notifications | Yes |
| PATCH | `/api/notifications/:id/read` | Mark notification as read | Yes |
| POST | `/api/notifications/mark-all-read` | Mark all notifications as read | Yes |

### Settings
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/settings` | Get system settings | No |
| GET | `/api/settings/company` | Get company information | No |

### CTOS Integration
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/ctos/ekyc` | Submit CTOS eKYC request | Yes |
| GET | `/api/ctos/status/:sessionId` | Get CTOS verification status | Yes |

### DocuSeal Integration
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/docuseal/create-submission` | Create DocuSeal submission | Admin |
| GET | `/api/docuseal/submission/:id` | Get submission status | Admin |
| POST | `/api/docuseal/webhook` | DocuSeal webhook endpoint | No |

### MTSA & PKI Integration
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/mtsa/enroll` | Enroll user for digital signing | Admin |
| POST | `/api/mtsa/sign` | Sign document via MTSA | Admin |
| GET | `/api/mtsa/status/:userId` | Get MTSA signing status | Admin |
| POST | `/api/pki/request-otp` | Request OTP for signing | Yes |
| POST | `/api/pki/verify-otp` | Verify OTP for signing | Yes |
| GET | `/api/pki/cert-status/:userId` | Get certificate status | Admin |

---

## üîê Admin Panel APIs (api.creditxpress.com.my/api/admin)

### Admin Authentication
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/admin/login` | Admin login | No |
| POST | `/api/admin/refresh` | Refresh admin token | No |
| POST | `/api/admin/logout` | Admin logout | Admin |
| GET | `/api/admin/me` | Get admin profile | Admin |
| PUT | `/api/admin/me` | Update admin profile | Admin |

### Dashboard & Analytics
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/dashboard` | Get dashboard statistics | Admin |
| GET | `/api/admin/monthly-stats` | Get monthly statistics | Admin |
| GET | `/api/admin/daily-stats` | Get daily statistics | Admin |

### User Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/users` | Get all users | Admin |
| GET | `/api/admin/users/:id` | Get specific user | Admin |
| PUT | `/api/admin/users/:id` | Update user | Admin |
| DELETE | `/api/admin/users/:id` | Delete user | Admin |

### Application Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/applications/counts` | Get application counts | Admin |
| GET | `/api/admin/applications` | Get all applications | Admin |
| GET | `/api/admin/applications/live-attestations` | Get live attestations | Admin |
| POST | `/api/admin/applications/:id/complete-live-attestation` | Complete live attestation | Admin |
| GET | `/api/admin/applications/:id` | Get specific application | Admin |
| PATCH | `/api/admin/applications/:id/status` | Update application status | Admin |
| POST | `/api/admin/applications/:id/fresh-offer` | Create fresh offer | Admin |
| POST | `/api/admin/applications/:id/disburse` | Disburse loan | Admin |
| POST | `/api/admin/applications/:id/complete-attestation` | Complete attestation | Admin |
| GET | `/api/admin/applications/:id/history` | Get application history | Admin |

### Document Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| PATCH | `/api/admin/documents/:id/status` | Update document status | Admin |

### Loan Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/loans` | Get all loans | Admin |
| GET | `/api/admin/loans/:id` | Get specific loan | Admin |
| GET | `/api/admin/loans/pending-discharge` | Get loans pending discharge | Admin |
| POST | `/api/admin/loans/:id/request-discharge` | Request loan discharge | Admin |
| POST | `/api/admin/loans/:id/approve-discharge` | Approve loan discharge | Admin |
| POST | `/api/admin/loans/:id/reject-discharge` | Reject loan discharge | Admin |
| POST | `/api/admin/loans/sync-balances` | Sync loan balances | Admin |
| GET | `/api/admin/loans/:id/transactions` | Get loan transactions | Admin |
| GET | `/api/admin/loans/:id/repayments` | Get loan repayments | Admin |

### Repayment Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/repayments/pending` | Get pending repayments | Admin |
| GET | `/api/admin/repayments` | Get all repayments | Admin |
| POST | `/api/admin/repayments/:id/approve` | Approve repayment | Admin |
| POST | `/api/admin/repayments/:id/reject` | Reject repayment | Admin |

### Payment Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/admin/payments/manual` | Create manual payment | Admin |
| POST | `/api/admin/payments/csv-upload` | Upload payment CSV | Admin |
| POST | `/api/admin/payments/csv-batch-approve` | Batch approve CSV payments | Admin |

### Late Fee Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/late-fees` | Get late fees | Admin |
| GET | `/api/admin/late-fees/status` | Get late fee processing status | Admin |
| POST | `/api/admin/late-fees/process` | Process late fees | Admin |
| GET | `/api/admin/late-fees/repayment/:repaymentId` | Get repayment late fees | Admin |
| GET | `/api/admin/late-fees/repayment/:repaymentId/total-due` | Get total due amount | Admin |
| POST | `/api/admin/late-fees/repayment/:repaymentId/handle-payment` | Handle late fee payment | Admin |
| POST | `/api/admin/late-fees/repayment/:repaymentId/waive` | Waive late fees | Admin |
| GET | `/api/admin/late-fees/logs` | Get late fee processing logs | Admin |
| DELETE | `/api/admin/late-fees/alerts` | Clear late fee alerts | Admin |

### Notification Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/notifications` | Get all notifications | Admin |
| GET | `/api/admin/notification-templates` | Get notification templates | Admin |
| POST | `/api/admin/notification-templates` | Create notification template | Admin |
| PUT | `/api/admin/notification-templates/:id` | Update notification template | Admin |
| DELETE | `/api/admin/notification-templates/:id` | Delete notification template | Admin |
| GET | `/api/admin/notification-groups` | Get notification groups | Admin |
| POST | `/api/admin/notification-groups` | Create notification group | Admin |
| PUT | `/api/admin/notification-groups/:id` | Update notification group | Admin |
| DELETE | `/api/admin/notification-groups/:id` | Delete notification group | Admin |
| POST | `/api/admin/send-notification` | Send notification | Admin |

### Disbursement Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/disbursements` | Get all disbursements | Admin |

### Product Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/products` | Get all products | Admin |

### Cron Job Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/cron/status` | Get cron job status | Admin |
| POST | `/api/admin/cron/trigger-late-fees` | Trigger late fee processing | Admin |
| POST | `/api/admin/trigger-upcoming-payment-notifications` | Trigger payment notifications | Admin |
| POST | `/api/admin/trigger-payment-notifications` | Trigger all payment notifications | Admin |

### Signing & Document Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/loans/:loanId/signatures` | Get loan signatures | Admin |
| GET | `/api/admin/applications/:applicationId/signatures` | Get application signatures | Admin |
| POST | `/api/admin/applications/pin-sign` | PIN-based signing | Admin |
| GET | `/api/admin/loans/:loanId/download-agreement` | Download loan agreement | Admin |
| GET | `/api/admin/loans/:loanId/download-stamped-agreement` | Download stamped agreement | Admin |
| POST | `/api/admin/loans/:id/upload-stamped-agreement` | Upload stamped agreement | Admin |
| POST | `/api/admin/loans/:id/upload-stamp-certificate` | Upload stamp certificate | Admin |
| GET | `/api/admin/loans/:loanId/download-stamp-certificate` | Download stamp certificate | Admin |

### PDF Letter Generation
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/:loanId/pdf-letters` | Get PDF letters for loan | Admin |
| GET | `/api/admin/:loanId/borrower-info` | Get borrower information | Admin |
| POST | `/api/admin/:loanId/generate-pdf-letter` | Generate PDF letter | Admin |
| GET | `/api/admin/:loanId/pdf-letters/:filename/download` | Download PDF letter | Admin |

### System Health
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/admin/health-check` | System health check | Admin |

---

## üîè Signing Orchestrator APIs (sign.creditxpress.com.my)

### Health Check Endpoints
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/health` | Basic health check | No |
| GET | `/health/detailed` | Detailed health check | No |
| GET | `/health/ready` | Kubernetes readiness probe | No |
| GET | `/health/live` | Kubernetes liveness probe | No |

### Webhook Endpoints
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/webhooks/docuseal` | DocuSeal webhook receiver | No (HMAC) |

### Manual Signing APIs
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/sign` | Manual document signing | API Key |
| POST | `/api/enroll` | Certificate enrollment | API Key |
| POST | `/api/verify` | Verify signed PDF | API Key |
| GET | `/api/cert/:userId` | Get certificate info | API Key |
| POST | `/api/otp` | Request OTP for signing | API Key |
| POST | `/api/verify-cert-pin` | Verify certificate PIN | API Key |
| POST | `/api/certificate` | Get certificate details | API Key |
| POST | `/api/revoke` | Revoke certificate | API Key |
| POST | `/api/test-getcert` | Test certificate retrieval | API Key |

### PKI Management APIs
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/pki/cert-status/:userId` | Get certificate status | API Key |
| POST | `/api/pki/request-otp` | Request OTP for PKI | API Key |
| POST | `/api/pki/complete-signing` | Complete signing process | API Key |
| GET | `/api/pki/session/:sessionId` | Get signing session | API Key |
| POST | `/api/pki/sign-pdf` | Sign PDF document | API Key |
| POST | `/api/pki/sign-pdf-pin` | Sign PDF with PIN | API Key |

### File Management APIs
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| GET | `/api/signed/:packetId` | List signed PDFs | API Key |
| GET | `/api/signed/:applicationId/download` | Download signed PDF | API Key |

### Admin Agreement Management
| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|---------------|
| POST | `/api/admin/agreements/:applicationId/upload/stamped` | Upload stamped agreement | API Key |
| POST | `/api/admin/agreements/:applicationId/upload/certificate` | Upload certificate | API Key |
| GET | `/api/admin/agreements/:applicationId/download/certificate` | Download certificate | API Key |
| GET | `/api/admin/agreements/:applicationId/download/stamped` | Download stamped agreement | API Key |

---

## üîí Security Notes for Penetration Testing

### Authentication Methods
1. **JWT Bearer Tokens**: Most endpoints require `Authorization: Bearer <token>`
2. **API Keys**: Signing orchestrator uses `X-API-Key: <key>` header
3. **HMAC Signatures**: DocuSeal webhooks use HMAC verification
4. **Role-Based Access**: Admin endpoints require specific roles (ADMIN/ATTESTOR/USER)

### Rate Limiting
- Most endpoints have rate limiting implemented
- Health check endpoints may have different limits
- File upload endpoints have size restrictions (50MB)

### CORS Configuration
- Production: Strict CORS policy
- Development: Localhost allowed
- Preflight requests handled for complex requests

### File Upload Security
- PDF validation on signing endpoints
- File size limits enforced
- MIME type validation
- Virus scanning may be implemented

### Sensitive Endpoints
- Payment processing endpoints
- Document signing workflows
- User data modification
- Admin privilege escalation paths
- File download/upload endpoints

---

## üìù Testing Notes

### High-Priority Targets
1. Authentication bypass attempts
2. Authorization escalation (user ‚Üí admin)
3. SQL injection in search/filter parameters
4. File upload vulnerabilities
5. IDOR (Insecure Direct Object References) in ID-based endpoints
6. Rate limiting bypass
7. CORS misconfigurations
8. JWT token manipulation
9. API key exposure/brute force
10. Webhook signature bypass

### Common Parameters to Test
- `id`, `userId`, `loanId`, `applicationId` (IDOR)
- `limit`, `offset`, `page` (SQL injection)
- `status`, `type`, `role` (enumeration)
- File upload fields (malicious files)
- Search/filter parameters (injection)

### Environment Considerations
- Production: `api.creditxpress.com.my`, `sign.creditxpress.com.my`
- Development: May have different security controls
- Staging: Check if accessible and has production data

---

*Last Updated: September 24, 2025*
*Platform: CreditXpress Digital Lending Platform*
*Scope: VPS Backend + On-Premises Signing Orchestrator*
